'use strict';

var app = angular.module('Battlecruiser', ['ui.router']);

app.config(function ($urlRouterProvider, $locationProvider) {
   // This turns off hashbang urls (/#about) and changes it to something normal (/about)
   $locationProvider.html5Mode(true);
   // If we go to a URL that ui-router doesn't have registered, go to the "/" url.
   $urlRouterProvider.otherwise('/');
});
'use strict';

app.directive('gameboard', function () {
	return {
		templateUrl: '/pre-build/board/board.html',
		restrict: 'E',
		scope: false
	};
});
'use strict';

app.factory('boardFactory', function ($http) {
	return {
		createGame: function createGame() {
			return $http.post('/api/game').then(function (res) {
				return res.data;
			});
		},
		playerSetup: function playerSetup(positionsArray) {
			return $http.put('/api/game/setup', { positionsArray: positionsArray }).then(function (res) {
				return res.data;
			});
		},
		playerMove: function playerMove(position) {
			return $http.put('/api/game/player', { position: position }).then(function (res) {
				return res.data;
			});
		},
		getCpuMove: function getCpuMove() {
			return $http.get('/api/game/cpu').then(function (res) {
				return res.data;
			});
		},
		deleteGame: function deleteGame() {
			return $http['delete']('/api/game').then(function (res) {
				return res.data;
			});
		}
	};
});
'use strict';

app.controller('HomeController', function ($scope, boardFactory) {
	$scope.EMPTY = 0;
	$scope.SHIP = 1;
	$scope.HIT = 2;
	$scope.MISS = 3;

	function isInArray(array, x, y) {
		return _.findIndex(array, { 'x': x, 'y': y });
	}

	$scope.positionSelected = function () {
		return isInArray($scope.positionsArray, this.$parent.$index, this.$index) > -1;
	};

	$scope.createBoards = function () {
		boardFactory.createGame().then(function (response) {
			$scope.game = response.game;
			$scope.positionsArray = [];
		});
	};

	$scope.submitPositions = function () {
		boardFactory.playerSetup($scope.positionsArray).then(function (response) {
			$scope.positionsArray = null;
			$scope.game = response.game;
		});
	};

	$scope.deleteGame = function () {
		boardFactory.deleteGame().then(function (response) {
			$scope.game = null;
			$scope.createBoards();
		});
	};

	$scope.selectPosition = function (x, y) {
		var index = isInArray($scope.positionsArray, x, y);
		//undo position selection if previously selected
		if (index > -1 && $scope.game.status === 'setup') {
			return $scope.positionsArray.splice(index, 1);
		}

		if ($scope.positionsArray && $scope.positionsArray.length < 10 && $scope.game.status === 'setup') {
			$scope.positionsArray.push({ 'x': x, 'y': y });
		}
	};

	$scope.submitPositions = function () {
		boardFactory.playerSetup($scope.positionsArray).then(function (response) {
			$scope.positionsArray = null;
			$scope.game = response.game;
		});
	};

	$scope.attackCPU = function (status, x, y) {
		//prevent selecting previously attacked positions
		if ($scope.game.status === 'playing' && $scope.game.currentPlayer === 'person' && (status === $scope.EMPTY || status === $scope.SHIP)) {
			boardFactory.playerMove({ 'x': x, 'y': y }).then(function (response) {
				$scope.game = response.game;
			});
		}
	};

	$scope.allowAttack = function () {
		boardFactory.getCpuMove().then(function (response) {
			$scope.game = response.game;
		});
	};
});
'use strict';

app.config(function ($stateProvider) {
    $stateProvider.state('home', {
        url: '/',
        templateUrl: '/pre-build/home/home.html',
        controller: 'HomeController'
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImJvYXJkL2JvYXJkLmRpcmVjdGl2ZS5qcyIsImJvYXJkL2JvYXJkLmZhY3RvcnkuanMiLCJob21lL2hvbWUuY29udHJvbGxlci5qcyIsImhvbWUvaG9tZS5zdGF0ZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksR0FBRyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsZUFBZSxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQzs7QUFFekQsR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLGtCQUFrQixFQUFFLGlCQUFpQixFQUFFOztBQUV6RCxvQkFBaUIsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7O0FBRWxDLHFCQUFrQixDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztDQUNwQyxDQUFDLENBQUM7OztBQ1BILEdBQUcsQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLFlBQVc7QUFDckMsUUFBTztBQUNOLGFBQVcsRUFBRSw2QkFBNkI7QUFDMUMsVUFBUSxFQUFFLEdBQUc7QUFDYixPQUFLLEVBQUUsS0FBSztFQUNaLENBQUM7Q0FDRixDQUFDLENBQUM7OztBQ05ILEdBQUcsQ0FBQyxPQUFPLENBQUMsY0FBYyxFQUFFLFVBQVMsS0FBSyxFQUFDO0FBQzFDLFFBQU87QUFDTixZQUFVLEVBQUUsc0JBQVc7QUFDdEIsVUFBTyxLQUFLLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUM3QixJQUFJLENBQUMsVUFBUyxHQUFHLEVBQUU7QUFDbkIsV0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDO0lBQ2hCLENBQUMsQ0FBQztHQUNIO0FBQ0QsYUFBVyxFQUFFLHFCQUFTLGNBQWMsRUFBRTtBQUNyQyxVQUFPLEtBQUssQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEVBQUUsRUFBQyxjQUFjLEVBQUUsY0FBYyxFQUFDLENBQUMsQ0FDcEUsSUFBSSxDQUFDLFVBQVMsR0FBRyxFQUFFO0FBQ25CLFdBQU8sR0FBRyxDQUFDLElB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RyxRQUFRLENBQUMsSUFBSSxDQUFDO0lBQzVCLENBQUMsQ0FBQTtHQUNGO0VBQ0QsQ0FBQTs7QUFFRCxPQUFNLENBQUMsV0FBVyxHQUFHLFlBQVc7QUFDL0IsY0FBWSxDQUFDLFVBQVUsRUFBRSxDQUN4QixJQUFJLENBQUMsVUFBUyxRQUFRLEVBQUU7QUFDeEIsU0FBTSxDQUFDLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDO0dBQzVCLENBQUMsQ0FBQTtFQUNGLENBQUE7Q0FDRCxDQUFDLENBQUM7OztBQzFFSCxHQUFHLENBQUMsTUFBTSxDQUFDLFVBQVMsY0FBYyxFQUFFO0FBQ2hDLGtCQUFjLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRTtBQUN6QixXQUFHLEVBQUUsR0FBRztBQUNSLG1CQUFXLEVBQUUsMkJBQTJCO0FBQ3hDLGtCQUFVLEVBQUUsZ0JBQWdCO0tBQy9CLENBQUMsQ0FBQztDQUNOLENBQUMsQ0FBQyIsImZpbGUiOiJidWlsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnQmF0dGxlY3J1aXNlcicsIFsndWkucm91dGVyJ10pO1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uICgkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAvLyBUaGlzIHR1cm5zIG9mZiBoYXNoYmFuZyB1cmxzICgvI2Fib3V0KSBhbmQgY2hhbmdlcyBpdCB0byBzb21ldGhpbmcgbm9ybWFsICgvYWJvdXQpXG4gICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gICAvLyBJZiB3ZSBnbyB0byBhIFVSTCB0aGF0IHVpLXJvdXRlciBkb2Vzbid0IGhhdmUgcmVnaXN0ZXJlZCwgZ28gdG8gdGhlIFwiL1wiIHVybC5cbiAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbn0pOyIsImFwcC5kaXJlY3RpdmUoJ2dhbWVib2FyZCcsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuXHRcdHRlbXBsYXRlVXJsOiAnL3ByZS1idWlsZC9ib2FyZC9ib2FyZC5odG1sJyxcblx0XHRyZXN0cmljdDogJ0UnLFxuXHRcdHNjb3BlOiBmYWxzZVxuXHR9O1xufSk7IiwiYXBwLmZhY3RvcnkoJ2JvYXJkRmFjdG9yeScsIGZ1bmN0aW9uKCRodHRwKXtcblx0cmV0dXJuIHtcblx0XHRjcmVhdGVHYW1lOiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2dhbWUnKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0cGxheWVyU2V0dXA6IGZ1bmN0aW9uKHBvc2l0aW9uc0FycmF5KSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucHV0KCcvYXBpL2dhbWUvc2V0dXAnLCB7cG9zaXRpb25zQXJyYXk6IHBvc2l0aW9uc0FycmF5fSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdHBsYXllck1vdmU6IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucHV0KCcvYXBpL2dhbWUvcGxheWVyJywge3Bvc2l0aW9uOiBwb3NpdGlvbn0pXG5cdFx0XHQudGhlbihmdW5jdGlvbihyZXMpIHtcblx0XHRcdFx0cmV0dXJuIHJlcy5kYXRhO1xuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRnZXRDcHVNb3ZlOiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZ2FtZS9jcHUnKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0ZGVsZXRlR2FtZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAuZGVsZXRlKCcvYXBpL2dhbWUnKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdH1cbn0pOyIsImFwcC5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgYm9hcmRGYWN0b3J5KSB7XG5cdCRzY29wZS5FTVBUWSA9IDA7XG5cdCRzY29wZS5TSElQID0gMTtcblx0JHNjb3BlLkhJVCA9IDI7XG5cdCRzY29wZS5NSVNTID0gMztcblxuXHRmdW5jdGlvbiBpc0luQXJyYXkoYXJyYXksIHgsIHkpIHtcblx0XHRyZXR1cm4gXy5maW5kSW5kZXgoYXJyYXksIHsneCc6IHgsICd5JzogeX0pO1xuXHR9XG5cblx0JHNjb3BlLnBvc2l0aW9uU2VsZWN0ZWQgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gaXNJbkFycmF5KCRzY29wZS5wb3NpdGlvbnNBcnJheSwgdGhpcy4kcGFyZW50LiRpbmRleCwgdGhpcy4kaW5kZXgpID4gLTE7XG5cdH1cblxuXHQkc2NvcGUuY3JlYXRlQm9hcmRzID0gZnVuY3Rpb24oKSB7XG5cdFx0Ym9hcmRGYWN0b3J5LmNyZWF0ZUdhbWUoKVxuXHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHQkc2NvcGUuZ2FtZSA9IHJlc3BvbnNlLmdhbWU7XG5cdFx0XHQkc2NvcGUucG9zaXRpb25zQXJyYXkgPSBbXTtcblx0XHR9KVxuXHR9XG5cblx0JHNjb3BlLnN1Ym1pdFBvc2l0aW9ucyA9IGZ1bmN0aW9uKCkge1xuXHRcdGJvYXJkRmFjdG9yeS5wbGF5ZXJTZXR1cCgkc2NvcGUucG9zaXRpb25zQXJyYXkpXG5cdFx0LnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdCRzY29wZS5wb3NpdGlvbnNBcnJheSA9IG51bGw7XG5cdFx0XHQkc2NvcGUuZ2FtZSA9IHJlc3BvbnNlLmdhbWU7XG5cdFx0fSlcblx0fVxuXG5cdCRzY29wZS5kZWxldGVHYW1lID0gZnVuY3Rpb24oKSB7XG5cdFx0Ym9hcmRGYWN0b3J5LmRlbGV0ZUdhbWUoKVxuXHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHQkc2NvcGUuZ2FtZSA9IG51bGw7XG5cdFx0XHQkc2NvcGUuY3JlYXRlQm9hcmRzKCk7XG5cdFx0fSlcblx0fVxuXG5cdCRzY29wZS5zZWxlY3RQb3NpdGlvbiA9IGZ1bmN0aW9uKHgsIHkpIHtcblx0XHR2YXIgaW5kZXggPSBpc0luQXJyYXkoJHNjb3BlLnBvc2l0aW9uc0FycmF5LCB4LCB5KTtcblx0XHQvL3VuZG8gcG9zaXRpb24gc2VsZWN0aW9uIGlmIHByZXZpb3VzbHkgc2VsZWN0ZWRcblx0XHRpZihpbmRleCA+IC0xICYmICRzY29wZS5nYW1lLnN0YXR1cyA9PT0gJ3NldHVwJykge1xuXHRcdFx0cmV0dXJuICRzY29wZS5wb3NpdGlvbnNBcnJheS5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdH1cblxuXHRcdGlmKCRzY29wZS5wb3NpdGlvbnNBcnJheSAmJiAkc2NvcGUucG9zaXRpb25zQXJyYXkubGVuZ3RoIDwgMTAgJiYgJHNjb3BlLmdhbWUuc3RhdHVzID09PSAnc2V0dXAnKSB7XG5cdFx0XHQkc2NvcGUucG9zaXRpb25zQXJyYXkucHVzaCh7J3gnOiB4LCAneSc6IHl9KTtcblx0XHR9XG5cdH1cblxuXHQkc2NvcGUuc3VibWl0UG9zaXRpb25zID0gZnVuY3Rpb24oKSB7XG5cdFx0Ym9hcmRGYWN0b3J5LnBsYXllclNldHVwKCRzY29wZS5wb3NpdGlvbnNBcnJheSlcblx0XHQudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0JHNjb3BlLnBvc2l0aW9uc0FycmF5ID0gbnVsbDtcblx0XHRcdCRzY29wZS5nYW1lID0gcmVzcG9uc2UuZ2FtZTtcblx0XHR9KVxuXHR9XG5cblx0JHNjb3BlLmF0dGFja0NQVSA9IGZ1bmN0aW9uKHN0YXR1cywgeCwgeSkge1xuXHRcdC8vcHJldmVudCBzZWxlY3RpbmcgcHJldmlvdXNseSBhdHRhY2tlZCBwb3NpdGlvbnNcblx0XHRpZigkc2NvcGUuZ2FtZS5zdGF0dXMgPT09ICdwbGF5aW5nJyAmJiAkc2NvcGUuZ2FtZS5jdXJyZW50UGxheWVyID09PSAncGVyc29uJyAmJiAoc3RhdHVzID09PSAkc2NvcGUuRU1QVFkgfHwgc3RhdHVzID09PSAkc2NvcGUuU0hJUCkpe1xuXHRcdFx0Ym9hcmRGYWN0b3J5LnBsYXllck1vdmUoeyd4JzogeCwgJ3knOiB5fSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdCRzY29wZS5nYW1lID0gcmVzcG9uc2UuZ2FtZTtcblx0XHRcdH0pXG5cdFx0fVxuXHR9XG5cblx0JHNjb3BlLmFsbG93QXR0YWNrID0gZnVuY3Rpb24oKSB7XG5cdFx0Ym9hcmRGYWN0b3J5LmdldENwdU1vdmUoKVxuXHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHQkc2NvcGUuZ2FtZSA9IHJlc3BvbnNlLmdhbWU7XG5cdFx0fSlcblx0fVxufSk7XG5cblx0IiwiYXBwLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlcikge1xuICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvcHJlLWJ1aWxkL2hvbWUvaG9tZS5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250cm9sbGVyJ1xuICAgIH0pO1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
